import{a as F,b as I,v as L,x as z,e as D,m as _,y as A,o as r,f as i,q as g,w as $,z as K,h as e,t as a,u as l,F as C,r as P,k as u,i as f,A as V,B as c,C as m,D as W,E as G,l as H}from"./entry.d2fb6768.js";const J={class:"w-full text-xl text-center uppercase mb-6"},Q={class:"flex"},X={class:"w-full px-4"},Y=["src"],Z={class:"w-full mr-6"},ee={class:"flex justify-between mt-4"},te={class:"text-xs"},oe={class:"font-bold"},se={class:"font-bold"},le={class:"text-xs"},ne={class:"font-bold"},ae={class:"font-bold"},re={class:"font-bold"},ie=["onClick"],de=e("i",{class:"pi pi-times"},null,-1),ce=[de],ue={key:0,class:"w-52 relative"},pe={class:"fixed border rounded p-2 shadow-md"},fe={class:"text-md mb-4"},me={class:"block mb-2"},be={class:"font-bold"},_e={key:0,class:"modal fixed top-0 left-0 w-full h-full flex justify-center items-center"},he={class:"w-80 relative z-20 bg-white py-2 px-4 rounded-md shadow-lg"},ve=e("i",{class:"pi pi-plus rotate-45"},null,-1),ye=[ve],xe=e("h2",{class:"text-2xl border-b border-slate-200"},"Оформление заказа",-1),ke={class:"mt-2"},we={class:"block mb-2"},ge=e("span",{class:"text-xs mb-1 block"},"ФИО",-1),$e={class:"block mb-2"},Ce=e("span",{class:"text-xs mb-1 block"},"Email",-1),Ve={class:"block mb-2"},Oe=e("span",{class:"text-xs mb-1 block"},"Телефон",-1),Se={class:"block mb-2"},De=e("span",{class:"text-xs mb-1 block"},"Способ доставки",-1),Pe=e("option",{value:""},"Способ доставки",-1),qe=e("option",{value:"самовывоз"},"Самовывоз",-1),Me=e("option",{value:"новая почта"},"Новая почта",-1),Ne=[Pe,qe,Me],Ue={class:"block mb-2"},Te=e("span",{class:"text-xs mb-1 block"},"Город",-1),je={key:0,class:"block mb-2 relative"},Re=e("span",{class:"text-xs mb-1 block"},"Отделение почты",-1),Be={key:0,class:"max-h-40 overflow-auto absolute bg-white border border-slate-200"},Ee=["onClick"],Fe={class:"block mb-2"},Ie=e("span",{class:"text-xs mb-1 block"},"Примечание к заказу",-1),Le={class:"flex justify-between items-center"},ze=e("button",{type:"submit",class:"bg-cyan-700 text-white hover:bg-cyan-900 py-2 px-6 text-xs uppercase font-bold rounded"},"Купить",-1),Ge=F({__name:"cart",setup(Ae){const d=I(),q=L(),h=z(),v=null,p=D(()=>h.cart),O={};p.value.map(s=>{O[s.id]=s.count});const n=_({fullname:"",phone:"",email:"",delivery:"",description:"",post_office:"",city:"",items:O});if(v.value)for(let s in v.value)Object.keys(n.value).indexOf(s)!==-1&&(n.value[s]=v.value[s]);const y=_(!1),M=()=>{let s=0;p.value.map(b=>{s+=b.price_retail*b.count});const o=s/100;return parseFloat(o.toString()).toFixed(2)},x=_([]),k=_(!0),N=async()=>{console.log(n.value.post_office);const{data:s}=await $fetch("https://api.novaposhta.ua/v2.0/json/",{method:"POST",body:{apiKey:"36546247000dc161cf93d55c035e8f1b",modelName:"Address",calledMethod:"getWarehouses",methodProperties:{CityName:n.value.city}}});x.value=s},U=D(()=>{const s=n.value.post_office;return s.length===0?[]:x.value.filter(o=>o[`Description${d.params.locale==="uk"?"":"Ru"}`].indexOf(s.trim())!==-1)}),T=s=>{n.value.post_office=s,k.value=!1},j=s=>{h.delete(s)},R=()=>{document.body.classList.add("overflow-hidden"),y.value=!0},w=()=>{document.body.classList.remove("overflow-hidden"),y.value=!1},B=async()=>{try{await $fetch("/api/v1/order",{method:"POST",body:n.value}),localStorage.removeItem("cart"),h.cart=[],q.replace(`/${d.params.locale}`)}catch(s){console.log(s)}};return A(()=>{p.value.length===0&&(window.location.href=`/${d.params.locale}`)}),(s,o)=>{const b=H,E=K;return r(),i("div",null,[g(E,null,{default:$(()=>[e("h1",J,a(s.$t("cart")),1),e("div",Q,[e("div",X,[l(p).length?(r(!0),i(C,{key:0},P(l(p),t=>(r(),i("div",{class:"w-full flex mb-2 border-t-2 p-2 relative",key:t.id},[g(b,{class:"w-4/12 pr-2",to:`/${l(d).params.locale}/product/${t.id}`},{default:$(()=>[t.images&&t.images.length>0?(r(),i("img",{key:0,src:`https://cdn.autotarget.com.ua/products/${t.images[0]}`},null,8,Y)):u("",!0)]),_:2},1032,["to"]),e("div",Z,[g(b,{to:`/${l(d).params.locale}/product/${t.id}`,class:"text-md leading-5 text-sky-800"},{default:$(()=>[f(a(t[`name_${l(d).params.locale}`]),1)]),_:2},1032,["to"]),e("div",ee,[e("ul",te,[e("li",null,[e("span",oe,a(s.$t("items.code_wholesale"))+": ",1),f(a(t.code_wholesale),1)]),e("li",null,[e("span",se,a(s.$t("items.code_vendor"))+": ",1),f(a(t.code_vendor),1)])]),e("ul",le,[e("li",null,[e("span",ne,a(s.$t("items.price"))+": ",1),f(a(t.price_retail/100)+" грн.",1)]),e("li",null,[e("span",ae,a(s.$t("count_items"))+": ",1),f(a(t.count)+" шт.",1)]),e("li",null,[e("span",re,a(s.$t("items.total_item"))+": ",1),f(" "+a(t.price_retail/100*t.count)+" грн.",1)])])])]),e("a",{href:"#",class:"absolute right-2 top-2 hover:rotate-90",onClick:V(S=>j(t.id),["prevent"])},ce,8,ie)]))),128)):u("",!0)]),l(p).length?(r(),i("div",ue,[e("div",pe,[e("p",fe,[e("span",me,a(s.$t("items.total"))+":",1),e("span",be,a(M())+" грн.",1)]),e("button",{onClick:o[0]||(o[0]=t=>R()),type:"button",class:"w-full bg-cyan-700 text-white hover:bg-cyan-900 py-2 px-6 text-xs uppercase font-bold rounded"},a(s.$t("order")),1)])])):u("",!0)]),l(y)?(r(),i("div",_e,[e("div",{class:"overlay fixed top-0 left-0 w-full h-full bg-slate-200 opacity-50 z-10",onClick:o[1]||(o[1]=t=>w())}),e("div",he,[e("form",{class:"relative",onSubmit:o[13]||(o[13]=V(t=>B(),["prevent"]))},[e("a",{href:"#",class:"absolute -right-7 -top-5 rounded-full bg-white border border-slate-200 p-2",onClick:o[2]||(o[2]=V(t=>w(),["prevent"]))},ye),xe,e("div",ke,[e("label",we,[ge,c(e("input",{class:"w-full form-input px-4 py-3 outline-0 border border-slate-200",type:"text",name:"fullname",placeholder:"ФИО","onUpdate:modelValue":o[3]||(o[3]=t=>l(n).fullname=t),required:"true"},null,512),[[m,l(n).fullname]])]),e("label",$e,[Ce,c(e("input",{class:"w-full form-input px-4 py-3 outline-0 border border-slate-200",type:"email",name:"email",placeholder:"Email","onUpdate:modelValue":o[4]||(o[4]=t=>l(n).email=t),required:"true"},null,512),[[m,l(n).email]])]),e("label",Ve,[Oe,c(e("input",{class:"w-full form-input px-4 py-3 outline-0 border border-slate-200",type:"tel",name:"phone",placeholder:"Телефон","onUpdate:modelValue":o[5]||(o[5]=t=>l(n).phone=t),required:"true"},null,512),[[m,l(n).phone]])]),e("label",Se,[De,c(e("select",{class:"w-full form-input px-4 py-3 outline-0 border border-slate-200",name:"delivery","onUpdate:modelValue":o[6]||(o[6]=t=>l(n).delivery=t),required:"true"},Ne,512),[[W,l(n).delivery]])]),l(n).delivery==="новая почта"?(r(),i(C,{key:0},[e("label",Ue,[Te,c(e("input",{onChange:o[7]||(o[7]=t=>N()),class:"w-full form-input px-4 py-3 outline-0 border border-slate-200",type:"text",name:"city",placeholder:"Город","onUpdate:modelValue":o[8]||(o[8]=t=>l(n).city=t),required:"true"},null,544),[[m,l(n).city]])]),l(n).city.length!=0?(r(),i("label",je,[Re,c(e("input",{onInput:o[9]||(o[9]=t=>{k.value=!0}),class:"w-full form-input px-4 py-3 outline-0 border border-slate-200",type:"text",name:"post_office",placeholder:"Отделение почты","onUpdate:modelValue":o[10]||(o[10]=t=>l(n).post_office=t),required:"true"},null,544),[[m,l(n).post_office]]),l(x).length>0&&l(n).post_office.length>0?c((r(),i("ul",Be,[(r(!0),i(C,null,P(l(U),(t,S)=>(r(),i("li",{key:S,onClick:Ke=>T(t[l(d).params.locale==="uk"?"Description":"DescriptionRu"]),class:"px-2 mb-2 text-xs hover:bg-slate-200"},a(t[l(d).params.locale==="uk"?"Description":"DescriptionRu"]),9,Ee))),128))],512)),[[G,l(k)]]):u("",!0)])):u("",!0)],64)):u("",!0),e("label",Fe,[Ie,c(e("textarea",{class:"w-full form-input px-4 py-3 outline-0 border border-slate-200",rows:"4","onUpdate:modelValue":o[11]||(o[11]=t=>l(n).description=t)},null,512),[[m,l(n).description]])]),e("div",Le,[e("button",{type:"button",class:"py-2 px-4 border border-slate-200 rounded hover:bg-slate-100",onClick:o[12]||(o[12]=t=>w())},"Закрыть"),ze])])],32)])])):u("",!0)]),_:1})])}}});export{Ge as default};
