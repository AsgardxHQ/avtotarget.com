import{a as j,b as R,v as I,B as L,e as B,m as _,C as z,o as a,f as n,q as g,w as E,D as G,h as e,t as l,u as r,F as $,r as V,k as c,i as f,A as C,y as d,E as m,z as K,G as W,l as H}from"./entry.3cb7d54a.mjs";const J={class:"w-full text-xl text-center uppercase mb-6"},Q={class:"flex"},X={class:"w-full px-4"},Y=["src"],Z={class:"w-full mr-6"},ee={class:"flex justify-between mt-4"},te={class:"text-xs"},oe={class:"font-bold"},se={class:"font-bold"},ue={class:"text-xs"},le={class:"font-bold"},ae={class:"font-bold"},ne={class:"font-bold"},re=["onClick"],ie=e("i",{class:"pi pi-times"},null,-1),de=[ie],ce={key:0,class:"w-52 relative"},pe={class:"fixed border rounded p-2 shadow-md"},fe={class:"text-md mb-4"},me={class:"block mb-2"},be={class:"font-bold"},_e={key:0,class:"modal fixed top-0 left-0 w-full h-full flex justify-center items-center"},ve={class:"w-80 relative z-20 bg-white py-2 px-4 rounded-md shadow-lg"},he=e("i",{class:"pi pi-plus rotate-45"},null,-1),ye=[he],xe=e("h2",{class:"text-2xl border-b border-slate-200"},"\u041E\u0444\u043E\u0440\u043C\u043B\u0435\u043D\u0438\u0435 \u0437\u0430\u043A\u0430\u0437\u0430",-1),ke={class:"mt-2"},we={class:"block mb-2"},ge=e("span",{class:"text-xs mb-1 block"},"\u0424\u0418\u041E",-1),Ee={class:"block mb-2"},$e=e("span",{class:"text-xs mb-1 block"},"Email",-1),Ce={class:"block mb-2"},De=e("span",{class:"text-xs mb-1 block"},"\u0422\u0435\u043B\u0435\u0444\u043E\u043D",-1),Fe={class:"block mb-2"},Be=e("span",{class:"text-xs mb-1 block"},"\u0421\u043F\u043E\u0441\u043E\u0431 \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0438",-1),Ve=e("option",{value:""},"\u0421\u043F\u043E\u0441\u043E\u0431 \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0438",-1),Ae=e("option",{value:"\u0441\u0430\u043C\u043E\u0432\u044B\u0432\u043E\u0437"},"\u0421\u0430\u043C\u043E\u0432\u044B\u0432\u043E\u0437",-1),Oe=e("option",{value:"\u043D\u043E\u0432\u0430\u044F \u043F\u043E\u0447\u0442\u0430"},"\u041D\u043E\u0432\u0430\u044F \u043F\u043E\u0447\u0442\u0430",-1),Se=[Ve,Ae,Oe],Pe={class:"block mb-2"},Ue=e("span",{class:"text-xs mb-1 block"},"\u0413\u043E\u0440\u043E\u0434",-1),qe={key:0,class:"block mb-2 relative"},Me=e("span",{class:"text-xs mb-1 block"},"\u041E\u0442\u0434\u0435\u043B\u0435\u043D\u0438\u0435 \u043F\u043E\u0447\u0442\u044B",-1),Ne={key:0,class:"max-h-40 overflow-auto absolute bg-white border border-slate-200"},Te=["onClick"],je={class:"block mb-2"},Re=e("span",{class:"text-xs mb-1 block"},"\u041F\u0440\u0438\u043C\u0435\u0447\u0430\u043D\u0438\u0435 \u043A \u0437\u0430\u043A\u0430\u0437\u0443",-1),Ie={class:"flex justify-between items-center"},Le=e("button",{type:"submit",class:"bg-cyan-700 text-white hover:bg-cyan-900 py-2 px-6 text-xs uppercase font-bold rounded"},"\u041A\u0443\u043F\u0438\u0442\u044C",-1),We=j({__name:"cart",setup(ze){const i=R(),A=I(),v=L(),h=useAuthUser(),p=B(()=>v.cart),D={};p.value.map(s=>{D[s.id]=s.count});const u=_({fullname:"",phone:"",email:"",delivery:"",description:"",post_office:"",city:"",items:D});if(h.value)for(let s in h.value)Object.keys(u.value).indexOf(s)!==-1&&(u.value[s]=h.value[s]);const y=_(!1),O=()=>{let s=0;p.value.map(b=>{s+=b.price_retail*b.count});const o=s/100;return parseFloat(o.toString()).toFixed(2)},x=_([]),k=_(!0),S=async()=>{console.log(u.value.post_office);const{data:s}=await $fetch("https://api.novaposhta.ua/v2.0/json/",{method:"POST",body:{apiKey:"36546247000dc161cf93d55c035e8f1b",modelName:"Address",calledMethod:"getWarehouses",methodProperties:{CityName:u.value.city}}});x.value=s},P=B(()=>{const s=u.value.post_office;return s.length===0?[]:x.value.filter(o=>o[`Description${i.params.locale==="uk"?"":"Ru"}`].indexOf(s.trim())!==-1)}),U=s=>{u.value.post_office=s,k.value=!1},q=s=>{v.delete(s)},M=()=>{document.body.classList.add("overflow-hidden"),y.value=!0},w=()=>{document.body.classList.remove("overflow-hidden"),y.value=!1},N=async()=>{try{await $fetch("/api/v1/order",{method:"POST",body:u.value}),localStorage.removeItem("cart"),v.cart=[],A.replace(`/${i.params.locale}`)}catch(s){console.log(s)}};return z(()=>{p.value.length===0&&(window.location.href=`/${i.params.locale}`)}),(s,o)=>{const b=H,T=G;return a(),n("div",null,[g(T,null,{default:E(()=>[e("h1",J,l(s.$t("cart")),1),e("div",Q,[e("div",X,[r(p).length?(a(!0),n($,{key:0},V(r(p),t=>(a(),n("div",{class:"w-full flex mb-2 border-t-2 p-2 relative",key:t.id},[g(b,{class:"w-4/12 pr-2",to:`/${r(i).params.locale}/product/${t.id}`},{default:E(()=>[t.images&&t.images.length>0?(a(),n("img",{key:0,src:`https://cdn.autotarget.com.ua/products/${t.images[0]}`},null,8,Y)):c("",!0)]),_:2},1032,["to"]),e("div",Z,[g(b,{to:`/${r(i).params.locale}/product/${t.id}`,class:"text-md leading-5 text-sky-800"},{default:E(()=>[f(l(t[`name_${r(i).params.locale}`]),1)]),_:2},1032,["to"]),e("div",ee,[e("ul",te,[e("li",null,[e("span",oe,l(s.$t("items.code_wholesale"))+": ",1),f(l(t.code_wholesale),1)]),e("li",null,[e("span",se,l(s.$t("items.code_vendor"))+": ",1),f(l(t.code_vendor),1)])]),e("ul",ue,[e("li",null,[e("span",le,l(s.$t("items.price"))+": ",1),f(l(t.price_retail/100)+" \u0433\u0440\u043D.",1)]),e("li",null,[e("span",ae,l(s.$t("count_items"))+": ",1),f(l(t.count)+" \u0448\u0442.",1)]),e("li",null,[e("span",ne,l(s.$t("items.total_item"))+": ",1),f(" "+l(t.price_retail/100*t.count)+" \u0433\u0440\u043D.",1)])])])]),e("a",{href:"#",class:"absolute right-2 top-2 hover:rotate-90",onClick:C(F=>q(t.id),["prevent"])},de,8,re)]))),128)):c("",!0)]),r(p).length?(a(),n("div",ce,[e("div",pe,[e("p",fe,[e("span",me,l(s.$t("items.total"))+":",1),e("span",be,l(O())+" \u0433\u0440\u043D.",1)]),e("button",{onClick:o[0]||(o[0]=t=>M()),type:"button",class:"w-full bg-cyan-700 text-white hover:bg-cyan-900 py-2 px-6 text-xs uppercase font-bold rounded"},l(s.$t("order")),1)])])):c("",!0)]),y.value?(a(),n("div",_e,[e("div",{class:"overlay fixed top-0 left-0 w-full h-full bg-slate-200 opacity-50 z-10",onClick:o[1]||(o[1]=t=>w())}),e("div",ve,[e("form",{class:"relative",onSubmit:o[13]||(o[13]=C(t=>N(),["prevent"]))},[e("a",{href:"#",class:"absolute -right-7 -top-5 rounded-full bg-white border border-slate-200 p-2",onClick:o[2]||(o[2]=C(t=>w(),["prevent"]))},ye),xe,e("div",ke,[e("label",we,[ge,d(e("input",{class:"w-full form-input px-4 py-3 outline-0 border border-slate-200",type:"text",name:"fullname",placeholder:"\u0424\u0418\u041E","onUpdate:modelValue":o[3]||(o[3]=t=>u.value.fullname=t),required:"true"},null,512),[[m,u.value.fullname]])]),e("label",Ee,[$e,d(e("input",{class:"w-full form-input px-4 py-3 outline-0 border border-slate-200",type:"email",name:"email",placeholder:"Email","onUpdate:modelValue":o[4]||(o[4]=t=>u.value.email=t),required:"true"},null,512),[[m,u.value.email]])]),e("label",Ce,[De,d(e("input",{class:"w-full form-input px-4 py-3 outline-0 border border-slate-200",type:"tel",name:"phone",placeholder:"\u0422\u0435\u043B\u0435\u0444\u043E\u043D","onUpdate:modelValue":o[5]||(o[5]=t=>u.value.phone=t),required:"true"},null,512),[[m,u.value.phone]])]),e("label",Fe,[Be,d(e("select",{class:"w-full form-input px-4 py-3 outline-0 border border-slate-200",name:"delivery","onUpdate:modelValue":o[6]||(o[6]=t=>u.value.delivery=t),required:"true"},Se,512),[[K,u.value.delivery]])]),u.value.delivery==="\u043D\u043E\u0432\u0430\u044F \u043F\u043E\u0447\u0442\u0430"?(a(),n($,{key:0},[e("label",Pe,[Ue,d(e("input",{onChange:o[7]||(o[7]=t=>S()),class:"w-full form-input px-4 py-3 outline-0 border border-slate-200",type:"text",name:"city",placeholder:"\u0413\u043E\u0440\u043E\u0434","onUpdate:modelValue":o[8]||(o[8]=t=>u.value.city=t),required:"true"},null,544),[[m,u.value.city]])]),u.value.city.length!=0?(a(),n("label",qe,[Me,d(e("input",{onInput:o[9]||(o[9]=t=>{k.value=!0}),class:"w-full form-input px-4 py-3 outline-0 border border-slate-200",type:"text",name:"post_office",placeholder:"\u041E\u0442\u0434\u0435\u043B\u0435\u043D\u0438\u0435 \u043F\u043E\u0447\u0442\u044B","onUpdate:modelValue":o[10]||(o[10]=t=>u.value.post_office=t),required:"true"},null,544),[[m,u.value.post_office]]),x.value.length>0&&u.value.post_office.length>0?d((a(),n("ul",Ne,[(a(!0),n($,null,V(r(P),(t,F)=>(a(),n("li",{key:F,onClick:Ge=>U(t[r(i).params.locale==="uk"?"Description":"DescriptionRu"]),class:"px-2 mb-2 text-xs hover:bg-slate-200"},l(t[r(i).params.locale==="uk"?"Description":"DescriptionRu"]),9,Te))),128))],512)),[[W,k.value]]):c("",!0)])):c("",!0)],64)):c("",!0),e("label",je,[Re,d(e("textarea",{class:"w-full form-input px-4 py-3 outline-0 border border-slate-200",rows:"4","onUpdate:modelValue":o[11]||(o[11]=t=>u.value.description=t)},null,512),[[m,u.value.description]])]),e("div",Ie,[e("button",{type:"button",class:"py-2 px-4 border border-slate-200 rounded hover:bg-slate-100",onClick:o[12]||(o[12]=t=>w())},"\u0417\u0430\u043A\u0440\u044B\u0442\u044C"),Le])])],32)])])):c("",!0)]),_:1})])}}});export{We as default};
